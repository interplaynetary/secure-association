{"version":3,"file":"rdx-cli.cjs","sources":["../src/rdx-cli.ts"],"sourcesContent":["#!/usr/bin/env node\n/**\n * RDX Command-Line Interface\n * Interactive tool for Recognition Derivatives Exchange (Decentralized)\n */\n\nimport { Command } from \"commander\";\nimport chalk from \"chalk\";\nimport { randomBytes } from \"crypto\";\nimport { HolsterStorage } from \"./holster-storage.js\";\nimport { createRecognitionValue, createCapacity } from \"./rdx-core.js\";\nimport { commit as createCommitment } from \"./crypto-core.js\";\nimport { MPCProtocol } from \"./crypto-core.js\";\n\n// Global storage instance (initialized on first command)\nlet storage: HolsterStorage | null = null;\nlet userId: string | null = null;\n\n/**\n * Initialize storage with user ID\n */\nasync function initStorage(did: string): Promise<HolsterStorage> {\n  if (storage && userId === did) {\n    return storage;\n  }\n\n  console.log(\n    chalk.blue(`\\nüîó Initializing decentralized storage for ${did}...`)\n  );\n  storage = new HolsterStorage({ indexedDB: false }); // Use filesystem for CLI\n  await storage.initialize(did);\n  userId = did;\n  console.log(chalk.green(\"‚úÖ Storage initialized\\n\"));\n\n  return storage;\n}\n\nconst program = new Command();\n\nprogram\n  .name(\"rdx\")\n  .description(\"Recognition Derivatives Exchange - CLI Tool\")\n  .version(\"1.0.0\");\n\n// ============================================================================\n// Register Command\n// ============================================================================\n\nprogram\n  .command(\"register\")\n  .description(\n    \"Register a new participant (initializes your decentralized storage)\"\n  )\n  .requiredOption(\n    \"--did <did>\",\n    \"Decentralized Identifier (e.g., did:example:alice)\"\n  )\n  .requiredOption(\"--name <name>\", \"Participant name\")\n  .option(\"--public-key <key>\", \"Public key (optional)\")\n  .action(async (options) => {\n    try {\n      console.log(chalk.blue(\"\\nüîê Registering participant...\"));\n      console.log(chalk.gray(`   DID: ${options.did}`));\n      console.log(chalk.gray(`   Name: ${options.name}`));\n\n      const publicKey =\n        options.publicKey ||\n        randomBytes(32).toString(\"hex\").slice(0, 16) + \"...\";\n\n      const store = await initStorage(options.did);\n      store.addParticipant(options.did, options.name, publicKey);\n\n      console.log(chalk.green(`\\n‚úÖ Successfully registered ${options.name}`));\n      console.log(chalk.gray(\"   Your decentralized storage is ready.\"));\n      console.log(\n        chalk.gray(\"   You can now declare capacities and express desires.\\n\")\n      );\n    } catch (error: any) {\n      console.error(chalk.red(`\\n‚ùå Error: ${error.message}\\n`));\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// List Participants Command\n// ============================================================================\n\nprogram\n  .command(\"list-participants\")\n  .description(\"List all registered participants\")\n  .requiredOption(\"--did <did>\", \"Your DID (for storage access)\")\n  .action(async (options) => {\n    try {\n      const store = await initStorage(options.did);\n      const participants = await store.listParticipants();\n\n      if (participants.length === 0) {\n        console.log(chalk.yellow(\"\\n‚ö†Ô∏è  No participants registered yet.\\n\"));\n        return;\n      }\n\n      console.log(chalk.blue(\"\\nüë• Registered Participants:\\n\"));\n      console.log(chalk.gray(\"‚îÄ\".repeat(70)));\n\n      for (const p of participants) {\n        console.log(chalk.white(`  ${p.name}`));\n        console.log(chalk.gray(`  DID: ${p.did}`));\n        if (p.publicKey) {\n          console.log(chalk.gray(`  Key: ${p.publicKey}`));\n        }\n        console.log(chalk.gray(\"‚îÄ\".repeat(70)));\n      }\n      console.log();\n    } catch (error: any) {\n      console.error(chalk.red(`\\n‚ùå Error: ${error.message}\\n`));\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// Set Recognition Command\n// ============================================================================\n\nprogram\n  .command(\"set-recognition\")\n  .description(\"Set recognition value between two participants\")\n  .requiredOption(\"--from-did <did>\", \"Recognition from this DID\")\n  .requiredOption(\"--to-did <did>\", \"Recognition to this DID\")\n  .requiredOption(\n    \"--percentage <value>\",\n    \"Recognition percentage (0-100)\",\n    parseFloat\n  )\n  .action(async (options) => {\n    try {\n      const store = await initStorage(options.fromDid);\n      const fromParticipant = await store.getParticipant(options.fromDid);\n      const toParticipant = await store.getParticipant(options.toDid);\n\n      if (!fromParticipant) {\n        throw new Error(`Participant ${options.fromDid} not found`);\n      }\n      if (!toParticipant) {\n        throw new Error(`Participant ${options.toDid} not found`);\n      }\n\n      console.log(chalk.blue(\"\\nü§ù Setting recognition:\"));\n      console.log(chalk.gray(`   From: ${options.fromDid}`));\n      console.log(chalk.gray(`   To: ${options.toDid}`));\n      console.log(chalk.gray(`   Recognition: ${options.percentage}%`));\n\n      // Create commitment\n      const recognition = createRecognitionValue(options.percentage);\n      const randomness = randomBytes(32);\n      const commitment = createCommitment(recognition.percentage, randomness);\n\n      console.log(chalk.blue(\"\\nüîí Creating cryptographic commitment...\"));\n\n      // Store commitment\n      store.addCommitment(\n        options.fromDid,\n        options.toDid,\n        commitment.value,\n        commitment.randomness\n      );\n\n      console.log(\n        chalk.green(\"‚úÖ Recognition commitment stored (syncing to network)\")\n      );\n      console.log(\n        chalk.gray(\n          `   Commitment: ${Buffer.from(commitment.value).toString(\"hex\").slice(0, 32)}...`\n        )\n      );\n      console.log(chalk.gray(\"   (Recognition value is kept private)\\n\"));\n    } catch (error: any) {\n      console.error(chalk.red(`\\n‚ùå Error: ${error.message}\\n`));\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// Declare Capacity Command\n// ============================================================================\n\nprogram\n  .command(\"declare-capacity\")\n  .description(\"Declare a new capacity (syncs to network)\")\n  .requiredOption(\"--provider-did <did>\", \"Provider DID\")\n  .requiredOption(\"--type <type>\", \"Capacity type (e.g., piano_lessons)\")\n  .requiredOption(\"--quantity <value>\", \"Total quantity\", parseFloat)\n  .requiredOption(\"--unit <unit>\", \"Unit (e.g., hours/week)\")\n  .option(\"--filters <json>\", \"Filters as JSON\", \"{}\")\n  .action(async (options) => {\n    try {\n      const store = await initStorage(options.providerDid);\n      const provider = await store.getParticipant(options.providerDid);\n      if (!provider) {\n        throw new Error(`Provider ${options.providerDid} not found`);\n      }\n\n      console.log(chalk.blue(\"\\nüì¶ Declaring capacity:\"));\n      console.log(chalk.gray(`   Provider: ${options.providerDid}`));\n      console.log(chalk.gray(`   Type: ${options.type}`));\n      console.log(\n        chalk.gray(`   Quantity: ${options.quantity} ${options.unit}`)\n      );\n\n      const capacityId = `cap-${randomBytes(8).toString(\"hex\")}`;\n      const filters = JSON.parse(options.filters);\n\n      const capacity = createCapacity(\n        capacityId,\n        options.providerDid,\n        options.type,\n        options.quantity,\n        options.unit,\n        filters\n      );\n\n      store.addCapacity(capacity);\n\n      console.log(\n        chalk.green(\"\\n‚úÖ Capacity declared successfully (syncing to network)\")\n      );\n      console.log(chalk.gray(`   Capacity ID: ${capacityId}`));\n      console.log(\n        chalk.gray(\"   Recipients can now express desire for this capacity\\n\")\n      );\n    } catch (error: any) {\n      console.error(chalk.red(`\\n‚ùå Error: ${error.message}\\n`));\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// List Capacities Command\n// ============================================================================\n\nprogram\n  .command(\"list-capacities\")\n  .description(\"List all declared capacities (from network)\")\n  .requiredOption(\"--did <did>\", \"Your DID (for storage access)\")\n  .option(\"--provider <did>\", \"Filter by provider DID\")\n  .action(async (options) => {\n    try {\n      const store = await initStorage(options.did);\n      const capacities = await store.listCapacities(options.provider);\n\n      if (capacities.length === 0) {\n        console.log(chalk.yellow(\"\\n‚ö†Ô∏è  No capacities declared yet.\\n\"));\n        return;\n      }\n\n      console.log(chalk.blue(\"\\nüì¶ Available Capacities:\\n\"));\n      console.log(chalk.gray(\"‚îÄ\".repeat(70)));\n\n      for (const c of capacities) {\n        console.log(chalk.white(`  ${c.capacityType}`));\n        console.log(chalk.gray(`  ID: ${c.id}`));\n        console.log(chalk.gray(`  Provider: ${c.providerDid}`));\n        console.log(chalk.gray(`  Quantity: ${c.totalQuantity} ${c.unit}`));\n        console.log(chalk.gray(\"‚îÄ\".repeat(70)));\n      }\n      console.log();\n    } catch (error: any) {\n      console.error(chalk.red(`\\n‚ùå Error: ${error.message}\\n`));\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// Express Desire Command\n// ============================================================================\n\nprogram\n  .command(\"express-desire\")\n  .description(\"Express desire for a capacity (syncs to network)\")\n  .requiredOption(\"--recipient-did <did>\", \"Recipient DID\")\n  .requiredOption(\"--capacity-id <id>\", \"Capacity ID\")\n  .requiredOption(\"--quantity <value>\", \"Desired quantity\", parseFloat)\n  .action(async (options) => {\n    try {\n      const store = await initStorage(options.recipientDid);\n      const recipient = await store.getParticipant(options.recipientDid);\n      if (!recipient) {\n        throw new Error(`Recipient ${options.recipientDid} not found`);\n      }\n\n      const capacity = await store.getCapacity(options.capacityId);\n      if (!capacity) {\n        throw new Error(`Capacity ${options.capacityId} not found`);\n      }\n\n      console.log(chalk.blue(\"\\nüí≠ Expressing desire:\"));\n      console.log(chalk.gray(`   Recipient: ${options.recipientDid}`));\n      console.log(chalk.gray(`   Capacity: ${options.capacityId}`));\n      console.log(chalk.gray(`   Quantity: ${options.quantity}`));\n\n      store.addDesire(\n        options.recipientDid,\n        options.capacityId,\n        options.quantity\n      );\n\n      console.log(\n        chalk.green(\"\\n‚úÖ Desire expressed successfully (syncing to network)\")\n      );\n      console.log(\n        chalk.gray(\"   Use compute-allocation to calculate allocations\\n\")\n      );\n    } catch (error: any) {\n      console.error(chalk.red(`\\n‚ùå Error: ${error.message}\\n`));\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// Compute Allocation Command\n// ============================================================================\n\nprogram\n  .command(\"compute-allocation\")\n  .description(\"Compute allocations for a capacity\")\n  .requiredOption(\"--provider-did <did>\", \"Provider DID (for storage access)\")\n  .requiredOption(\"--capacity-id <id>\", \"Capacity ID\")\n  .option(\"--use-tee\", \"Use TEE simulation\", false)\n  .action(async (options) => {\n    try {\n      const store = await initStorage(options.providerDid);\n      const capacity = await store.getCapacity(options.capacityId);\n      if (!capacity) {\n        throw new Error(`Capacity ${options.capacityId} not found`);\n      }\n\n      console.log(\n        chalk.blue(\"\\n‚öôÔ∏è  Computing allocation for capacity:\", capacity.id)\n      );\n      console.log(chalk.gray(`   Provider: ${capacity.providerDid}`));\n      console.log(\n        chalk.gray(`   Total: ${capacity.totalQuantity} ${capacity.unit}`)\n      );\n\n      // Get desires\n      const desires = await store.getDesires(options.capacityId);\n      console.log(chalk.blue(`\\nüìä Found ${desires.length} desire(s)\\n`));\n\n      if (desires.length === 0) {\n        console.log(\n          chalk.yellow(\"‚ö†Ô∏è  No desires expressed for this capacity.\\n\")\n        );\n        return;\n      }\n\n      // Get commitments and compute MR\n      const mpc = new MPCProtocol(3);\n      const mrShares: Record<string, any> = {};\n      const desireMap: Record<string, number> = {};\n\n      for (const desire of desires) {\n        console.log(\n          chalk.gray(`   Processing recipient: ${desire.recipientDid}`)\n        );\n\n        // Get commitments\n        const commitmentProv = await store.getCommitment(\n          capacity.providerDid,\n          desire.recipientDid\n        );\n        const commitmentRecip = await store.getCommitment(\n          desire.recipientDid,\n          capacity.providerDid\n        );\n\n        if (!commitmentProv || !commitmentRecip) {\n          console.log(chalk.yellow(`   ‚ö†Ô∏è  Missing commitments, skipping...`));\n          continue;\n        }\n\n        // For demo, assume we can reconstruct (in reality, this would be MPC)\n        // Here we're simulating with placeholder values\n        const mrValue = 15.0; // Simplified for demo\n        mrShares[desire.recipientDid] = mpc.secretShare(mrValue, 3);\n        desireMap[desire.recipientDid] = desire.quantity;\n      }\n\n      console.log(chalk.blue(\"\\nüîê Running secure computation...\\n\"));\n\n      // Compute allocation\n      const allocations = mpc.computeNormalizedAllocation(\n        mrShares,\n        capacity.totalQuantity,\n        desireMap\n      );\n\n      console.log(chalk.green(\"‚úÖ Allocation computed successfully!\\n\"));\n      console.log(chalk.blue(\"üìä Results:\\n\"));\n      console.log(chalk.gray(\"‚îÄ\".repeat(70)));\n\n      for (const [recipientDid, quantity] of Object.entries(allocations)) {\n        console.log(chalk.white(`   Recipient: ${recipientDid}`));\n        console.log(\n          chalk.green(`   Allocated: ${quantity.toFixed(2)} ${capacity.unit}`)\n        );\n        console.log(chalk.gray(\"‚îÄ\".repeat(70)));\n\n        // Store allocation\n        store.addAllocation({\n          capacityId: capacity.id,\n          recipientDid,\n          quantityAllocated: quantity,\n          confirmed: false,\n        } as any);\n      }\n\n      if (options.useTee) {\n        console.log(\n          chalk.blue(\"\\nüîê TEE Attestation: RDX_Allocation_Enclave_v1\")\n        );\n      }\n\n      console.log();\n    } catch (error: any) {\n      console.error(chalk.red(`\\n‚ùå Error: ${error.message}\\n`));\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// Show Allocation Command\n// ============================================================================\n\nprogram\n  .command(\"show-allocation\")\n  .description(\"Show allocation for a capacity (from network)\")\n  .requiredOption(\"--did <did>\", \"Your DID (for storage access)\")\n  .requiredOption(\"--capacity-id <id>\", \"Capacity ID\")\n  .action(async (options) => {\n    try {\n      const store = await initStorage(options.did);\n      const capacity = await store.getCapacity(options.capacityId);\n      if (!capacity) {\n        throw new Error(`Capacity ${options.capacityId} not found`);\n      }\n\n      const allocations = await store.getAllocations(options.capacityId);\n\n      if (allocations.length === 0) {\n        console.log(chalk.yellow(\"\\n‚ö†Ô∏è  No allocations computed yet.\\n\"));\n        return;\n      }\n\n      console.log(chalk.blue(\"\\nüìä Allocations:\\n\"));\n      console.log(chalk.gray(\"‚îÄ\".repeat(70)));\n\n      for (const alloc of allocations) {\n        console.log(chalk.white(`   Recipient: ${alloc.recipientDid}`));\n        console.log(\n          chalk.green(\n            `   Allocated: ${alloc.quantityAllocated} ${capacity.unit}`\n          )\n        );\n        console.log(\n          chalk.gray(`   Confirmed: ${alloc.confirmed ? \"Yes\" : \"No\"}`)\n        );\n        console.log(chalk.gray(\"‚îÄ\".repeat(70)));\n      }\n      console.log();\n    } catch (error: any) {\n      console.error(chalk.red(`\\n‚ùå Error: ${error.message}\\n`));\n      process.exit(1);\n    }\n  });\n\n// ============================================================================\n// Parse and Execute\n// ============================================================================\n\nprogram.parse();\n"],"names":["storage","userId","initStorage","did","chalk","HolsterStorage","program","Command","options","publicKey","randomBytes","error","participants","p","store","fromParticipant","toParticipant","recognition","createRecognitionValue","randomness","commitment","createCommitment","capacityId","filters","capacity","createCapacity","capacities","c","desires","mpc","MPCProtocol","mrShares","desireMap","desire","commitmentProv","commitmentRecip","mrValue","allocations","recipientDid","quantity","alloc"],"mappings":"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"}